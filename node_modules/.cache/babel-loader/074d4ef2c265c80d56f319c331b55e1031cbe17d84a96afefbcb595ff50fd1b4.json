{"ast":null,"code":"/* ===== Helpers pour TruckTable et ScheduleView ===== */// Convertit \"oui\"/\"non\"/\"true\"/\"false\" en booléen\nexport function toBoolOuiNon(val){const v=(val||\"\").toString().trim().toLowerCase();if(v===\"oui\"||v===\"yes\"||v===\"true\")return true;if(v===\"non\"||v===\"no\"||v===\"false\")return false;return null;}// Mappe une ligne CSV truck_status en objet\nexport function mapRow(obj){var _obj$Unité,_obj$DATE,_obj$PLAINTE,_obj$DATERÉPARATION,_obj$GARAGE,_obj$COMPLÉTÉE,_obj$PROCHAINEDATED,_obj$PROCHAINRENDEZ,_ref,_obj$DISPONIBLE,_obj$NOTE;return{unite:((_obj$Unité=obj[\"Unité\"])===null||_obj$Unité===void 0?void 0:_obj$Unité.trim())||\"\",date:((_obj$DATE=obj[\"DATE\"])===null||_obj$DATE===void 0?void 0:_obj$DATE.trim())||\"\",plainte:((_obj$PLAINTE=obj[\"PLAINTE\"])===null||_obj$PLAINTE===void 0?void 0:_obj$PLAINTE.trim())||\"\",dateReparation:((_obj$DATERÉPARATION=obj[\"DATE RÉPARATION\"])===null||_obj$DATERÉPARATION===void 0?void 0:_obj$DATERÉPARATION.trim())||\"\",garage:((_obj$GARAGE=obj[\"GARAGE\"])===null||_obj$GARAGE===void 0?void 0:_obj$GARAGE.trim())||\"\",completee:((_obj$COMPLÉTÉE=obj[\"COMPLÉTÉE\"])===null||_obj$COMPLÉTÉE===void 0?void 0:_obj$COMPLÉTÉE.trim())||\"\",prochainRdv:((_obj$PROCHAINEDATED=obj[\"PROCHAINE DATE DE RÉPARATION\"])===null||_obj$PROCHAINEDATED===void 0?void 0:_obj$PROCHAINEDATED.trim())||((_obj$PROCHAINRENDEZ=obj[\"PROCHAIN RENDEZ-VOUS\"])===null||_obj$PROCHAINRENDEZ===void 0?void 0:_obj$PROCHAINRENDEZ.trim())||\"\",disponible:toBoolOuiNon((_ref=(_obj$DISPONIBLE=obj[\"DISPONIBLE\"])!==null&&_obj$DISPONIBLE!==void 0?_obj$DISPONIBLE:obj[\"Disponible\"])!==null&&_ref!==void 0?_ref:obj[\"APTE À ROULER\"]),note:((_obj$NOTE=obj[\"NOTE\"])===null||_obj$NOTE===void 0?void 0:_obj$NOTE.trim())||\"\"};}// Catégorise les unités\nexport function categorize(unite){const u=(unite||\"\").trim().toUpperCase();if(u.startsWith(\"RO\"))return\"ROLL-OFF\";if(u.startsWith(\"CA\"))return\"CHARGEMENT AVANT\";if(u.startsWith(\"LA\"))return\"CHARGEMENT LATÉRAL\";return\"Autres camions\";}// Crée les sections de statut pour TruckTable\nexport function buildStatusSections(rows){const order=[\"ROLL-OFF\",\"CHARGEMENT AVANT\",\"CHARGEMENT LATÉRAL\",\"Autres camions\"];const buckets=Object.fromEntries(order.map(k=>[k,[]]));for(const r of rows)buckets[categorize(r.unite)].push(r);return order.map(name=>({name,type:\"status\",rows:buckets[name]}));}// Formate date pour affichage\nexport function formatDateTime(d){try{return new Intl.DateTimeFormat(\"fr-CA\",{dateStyle:\"medium\",timeStyle:\"short\"}).format(d);}catch(_unused){return d.toLocaleString();}}// Parsing du schedule.csv\nexport function parseScheduleText(text){const clean=text.replace(/^\\uFEFF/,\"\");const lines=clean.split(/\\r?\\n/).filter(l=>l.trim().length>0);if(!lines.length)return{title:\"\",rows:{}};const title=lines[0].split(\";\").filter(c=>c.trim().length>0).join(\" \");const grouped={};let currentSupplier=\"\";for(let i=1;i<lines.length;i++){const line=lines[i].trim();if(!line)continue;const cells=line.split(\";\").map(c=>c.trim());const supplier=cells[0]||currentSupplier;currentSupplier=supplier||currentSupplier;const jour=cells[1]||\"\";const units=cells.slice(2).map(u=>u.toUpperCase()).filter(Boolean);if(!grouped[currentSupplier])grouped[currentSupplier]=[];grouped[currentSupplier].push({supplier:currentSupplier,jour,units});}return{title,rows:grouped};}// ===== ScheduleView helpers =====\nexport function getDayClass(jour){const j=(jour||\"\").toLowerCase().trim();if(j.includes(\"lundi\"))return\"day-lundi\";if(j.includes(\"mardi\"))return\"day-mardi\";if(j.includes(\"mercredi\"))return\"day-mercredi\";if(j.includes(\"jeudi\"))return\"day-jeudi\";if(j.includes(\"vendredi\"))return\"day-vendredi\";return\"\";}export function isCurrentDay(jour){const today=new Date();const dayNames=[\"dimanche\",\"lundi\",\"mardi\",\"mercredi\",\"jeudi\",\"vendredi\",\"samedi\"];const currentDayName=dayNames[today.getDay()];const j=(jour||\"\").toLowerCase().trim();return j.includes(currentDayName);}","map":{"version":3,"names":["toBoolOuiNon","val","v","toString","trim","toLowerCase","mapRow","obj","_obj$Unité","_obj$DATE","_obj$PLAINTE","_obj$DATERÉPARATION","_obj$GARAGE","_obj$COMPLÉTÉE","_obj$PROCHAINEDATED","_obj$PROCHAINRENDEZ","_ref","_obj$DISPONIBLE","_obj$NOTE","unite","date","plainte","dateReparation","garage","completee","prochainRdv","disponible","note","categorize","u","toUpperCase","startsWith","buildStatusSections","rows","order","buckets","Object","fromEntries","map","k","r","push","name","type","formatDateTime","d","Intl","DateTimeFormat","dateStyle","timeStyle","format","_unused","toLocaleString","parseScheduleText","text","clean","replace","lines","split","filter","l","length","title","c","join","grouped","currentSupplier","i","line","cells","supplier","jour","units","slice","Boolean","getDayClass","j","includes","isCurrentDay","today","Date","dayNames","currentDayName","getDay"],"sources":["C:/Users/FabienRobert/OneDrive - Villéco/Documents/GitHub/suivis_truck/src/utils.js"],"sourcesContent":["/* ===== Helpers pour TruckTable et ScheduleView ===== */\r\n\r\n// Convertit \"oui\"/\"non\"/\"true\"/\"false\" en booléen\r\nexport function toBoolOuiNon(val) {\r\n  const v = (val || \"\").toString().trim().toLowerCase();\r\n  if (v === \"oui\" || v === \"yes\" || v === \"true\") return true;\r\n  if (v === \"non\" || v === \"no\" || v === \"false\") return false;\r\n  return null;\r\n}\r\n\r\n// Mappe une ligne CSV truck_status en objet\r\nexport function mapRow(obj) {\r\n  return {\r\n    unite: obj[\"Unité\"]?.trim() || \"\",\r\n    date: obj[\"DATE\"]?.trim() || \"\",\r\n    plainte: obj[\"PLAINTE\"]?.trim() || \"\",\r\n    dateReparation: obj[\"DATE RÉPARATION\"]?.trim() || \"\",\r\n    garage: obj[\"GARAGE\"]?.trim() || \"\",\r\n    completee: obj[\"COMPLÉTÉE\"]?.trim() || \"\",\r\n    prochainRdv:\r\n      obj[\"PROCHAINE DATE DE RÉPARATION\"]?.trim() ||\r\n      obj[\"PROCHAIN RENDEZ-VOUS\"]?.trim() ||\r\n      \"\",\r\n    disponible: toBoolOuiNon(\r\n      obj[\"DISPONIBLE\"] ?? obj[\"Disponible\"] ?? obj[\"APTE À ROULER\"]\r\n    ),\r\n    note: obj[\"NOTE\"]?.trim() || \"\",\r\n  };\r\n}\r\n\r\n// Catégorise les unités\r\nexport function categorize(unite) {\r\n  const u = (unite || \"\").trim().toUpperCase();\r\n  if (u.startsWith(\"RO\")) return \"ROLL-OFF\";\r\n  if (u.startsWith(\"CA\")) return \"CHARGEMENT AVANT\";\r\n  if (u.startsWith(\"LA\")) return \"CHARGEMENT LATÉRAL\";\r\n  return \"Autres camions\";\r\n}\r\n\r\n// Crée les sections de statut pour TruckTable\r\nexport function buildStatusSections(rows) {\r\n  const order = [\"ROLL-OFF\", \"CHARGEMENT AVANT\", \"CHARGEMENT LATÉRAL\", \"Autres camions\"];\r\n  const buckets = Object.fromEntries(order.map(k => [k, []]));\r\n  for (const r of rows) buckets[categorize(r.unite)].push(r);\r\n  return order.map(name => ({ name, type: \"status\", rows: buckets[name] }));\r\n}\r\n\r\n// Formate date pour affichage\r\nexport function formatDateTime(d) {\r\n  try {\r\n    return new Intl.DateTimeFormat(\"fr-CA\", {\r\n      dateStyle: \"medium\",\r\n      timeStyle: \"short\",\r\n    }).format(d);\r\n  } catch {\r\n    return d.toLocaleString();\r\n  }\r\n}\r\n\r\n// Parsing du schedule.csv\r\nexport function parseScheduleText(text) {\r\n  const clean = text.replace(/^\\uFEFF/, \"\");\r\n  const lines = clean.split(/\\r?\\n/).filter(l => l.trim().length > 0);\r\n\r\n  if (!lines.length) return { title: \"\", rows: {} };\r\n\r\n  const title = lines[0].split(\";\").filter(c => c.trim().length > 0).join(\" \");\r\n\r\n  const grouped = {};\r\n  let currentSupplier = \"\";\r\n\r\n  for (let i = 1; i < lines.length; i++) {\r\n    const line = lines[i].trim();\r\n    if (!line) continue;\r\n\r\n    const cells = line.split(\";\").map(c => c.trim());\r\n    const supplier = cells[0] || currentSupplier;\r\n    currentSupplier = supplier || currentSupplier;\r\n\r\n    const jour = cells[1] || \"\";\r\n    const units = cells.slice(2).map(u => u.toUpperCase()).filter(Boolean);\r\n\r\n    if (!grouped[currentSupplier]) grouped[currentSupplier] = [];\r\n    grouped[currentSupplier].push({ supplier: currentSupplier, jour, units });\r\n  }\r\n\r\n  return { title, rows: grouped };\r\n}\r\n\r\n// ===== ScheduleView helpers =====\r\nexport function getDayClass(jour) {\r\n  const j = (jour || \"\").toLowerCase().trim();\r\n  if (j.includes(\"lundi\")) return \"day-lundi\";\r\n  if (j.includes(\"mardi\")) return \"day-mardi\";\r\n  if (j.includes(\"mercredi\")) return \"day-mercredi\";\r\n  if (j.includes(\"jeudi\")) return \"day-jeudi\";\r\n  if (j.includes(\"vendredi\")) return \"day-vendredi\";\r\n  return \"\";\r\n}\r\n\r\nexport function isCurrentDay(jour) {\r\n  const today = new Date();\r\n  const dayNames = [\"dimanche\",\"lundi\",\"mardi\",\"mercredi\",\"jeudi\",\"vendredi\",\"samedi\"];\r\n  const currentDayName = dayNames[today.getDay()];\r\n  const j = (jour || \"\").toLowerCase().trim();\r\n  return j.includes(currentDayName);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}